clearvarsclose alltic% gera (NumeroQuadrados) ondas quadradas com diferentes delays% mas duty cycle sempre 50 %% frequencia/duty cycle dado por pzeros e ponestamanho=1000;tamanhoMaior = 2000;NumeroQuadrados=2000;tempo=0:1:tamanho-1;AmpRuido = 1;%quadradoCell = horzcat(ones(1,pones),zeros(1,pzeros));%quadradoGrandao = repmat(quadradoCell,...%[1,round(tamanhoMaior/length(quadradoCell)),1]);%for count=1:NumeroQuadrados%  p= round(tamanho*0.5*rand(1))%  quadrado(count,:) = quadradoGrandao(p:tamanho+p-1);%endpzeros = 20;pones  = 20;quadradoCell = horzcat(ones(1,pones),zeros(1,pzeros));quadradoGrandao = repmat(quadradoCell,...[1,round(tamanhoMaior/length(quadradoCell)),1]);for count=1:NumeroQuadrados  p= round(tamanho*0.5*rand(1));  quadrado1(count,:) = quadradoGrandao(p+1:tamanho+p+1-1);endfigure(1)plot(tempo, quadrado1(1,:), '-r',...tempo, quadrado1(2,:), '-g')%csvwrite('quadrado.csv', quadrado1)csvwrite('Lixo.csv', quadrado1) %coloquei esse aqui pra nao perder o original, apenas pra ver o tempo% adiciona ruidofor count=1:NumeroQuadrados  p= round(tamanho*0.5*rand(1));  quadradoNoise(count,:) = -.5 + AmpRuido.*rand(1,tamanho) + quadrado1(count,:);endfigure(2)plot((1:1:1000), quadrado1(11,:), 'r', (1:1:1000), quadradoNoise(11,:) ,'k', 'Linewidth', 1)ylabel('Amplitude','FontSize',12,'Interpreter','Latex')texto={'Clean', 'Noisy'};legend(texto,'Interpreter','latex','FontSize',12, 'Location', 'best');%xlabel('Frequency [MHz]','FontSize',12,'Interpreter','Latex')%ylabel('Electric Field inside the cavity [dBm]','Interpreter','latex','FontSize',12)set(gca,'Fontname','Latin Modern Roman','FontSize',12)returnfigure(2)plot(tempo, quadrado1(2,:), '-rx',tempo, quadradoNoise(2,:), '-gx')%csvwrite('quadradoNoise.csv', quadradoNoise)csvwrite('LixoNoise.csv', quadrado1) %coloquei esse aqui pra nao perder o original, apenas pra ver o tempo% calculo SNRSNR= 10.*log10(sum(quadrado1.^2,2)./(sum(quadradoNoise.^2,2)));figure(2)plot(SNR, 'Linewidth',2)ylabel('SNR [dB]','Interpreter','latex','FontSize',12)xlabel('Waveform sample','FontSize',12,'Interpreter','Latex')%texto={'gap=0.1 mm', 'gap=0.55 mm', 'gap=1 mm'};%legend(texto,'Interpreter','latex','FontSize',12, 'Location', 'best');%xlabel('Frequency [MHz]','FontSize',12,'Interpreter','Latex')%ylabel('Electric Field inside the cavity [dBm]','Interpreter','latex','FontSize',12)set(gca,'Fontname','Latin Modern Roman','FontSize',12)figure(3)histogram(SNR)xlabel('SNR [dB]','Interpreter','latex','FontSize',12)ylabel('# samples','FontSize',12,'Interpreter','Latex')%texto={'gap=0.1 mm', 'gap=0.55 mm', 'gap=1 mm'};%legend(texto,'Interpreter','latex','FontSize',12, 'Location', 'best');%xlabel('Frequency [MHz]','FontSize',12,'Interpreter','Latex')%ylabel('Electric Field inside the cavity [dBm]','Interpreter','latex','FontSize',12)set(gca,'Fontname','Latin Modern Roman','FontSize',12)toc